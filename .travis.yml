language: python

# Make sure we run all 'test' stages before we deply
# and ensure we only deploy from production branches / tags
#stages:
#  - test
#  - name: deploy
#    if: tag IS present

# Generate a matrix for all Python versions we support
matrix:
  include:
    - name: "Python 2.7 tests"
      python: 2.7
      env: TOXENV=py27
    - name: "Python 3.4 tests"
      python: 3.4
      env: TOXENV=py34
    - name: "Python 3.5 tests"
      python: 3.5
      env: TOXENV=py35
    - name: "Python 3.6 tests"
      python: 3.6
      env: TOXENV=py36
    - name: "Python 3.7 tests"
      python: 3.7
      env: TOXENV=py37
    - name: "Python pypy 2 tests"
      python: pypy
      env: TOXENV=pypy
    - name: "Python pypy 3 tests"
      python: pypy3
      env: TOXENV=pypy3
#      dist: xenial
#      sudo: true

# Install all of our build-time dependencies
install: pip install wheel twine tox coveralls

# Scripts for the default "test" stage
# one copy of this default job will be generated for each python
# version stated above
script:
  - tox

# Default a secondary, custom job that only runs after the default 'test'
# job completes successfully
# NOTE: Deploy stages will only run on tags or off the master branch as
#       defined in the stage declarations above
# NOTE: We've restricted this deploy job to only run for the latest Python
#       version. Since we are generating a version-agnostic package this
#       should 'just work' on all other supported versions.
#jobs:
#  include:
#    - stage: deploy
#      python: 3.6
#      script:
#        - python setup.py bdist_wheel
#        - twine upload dist/*.whl -u $DEPLOY_USER -p $DEPLOY_PASS
#
#after_success:
# - coveralls